<%# app/views/modals/show.js.erb %>
var room_id;

<%# First render the modal %>
$('#myModal').html("<%= j render :partial => @modal_partial, 
                                 locals: { :header_glyphicon => @header_glyphicon,
                                           :header_title => @header_title,
                                           :modal_id => @modal_id
                                         }
                    %>");

<%# Then render the specific dynamic form %>
$('.modal-body').html("<%= j render :partial => @form_partial, 
                                    locals: { :object => @object,
                                              :form_data => @form_data
                                            } 
                       %>");

<%# Show the modal %>
$('<%= "#" + @modal_id %>').modal('show');

<%# Put a listener for submitting %>
$('#modal-submit').click(function() {
    $('<%= "#" + @modal_id %>').modal('hide');
});

<%# Closes the edit room dropdown without changing the page (the entries are <a> tags) %>
$('.room-selection').click(function() {
    $("#edit-plug-room-dropdown").dropdown("toggle"); 
    $('#current-room-name').html($(this).html());
    
    <%# Update plug[room_id] to reflect the newest room id %>
    $('#plug-room-id').attr("value", $(this).find("span:last").text());
    
    <%# returning false prevents the page from submitting %>
    return false;
});